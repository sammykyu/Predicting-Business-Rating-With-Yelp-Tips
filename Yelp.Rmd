---
title: "Yelp"
author: "Sammy"
date: "October 6, 2015"
output: html_document
---

```{r}
library(jsonlite)
bus <- stream_in(file("yelp_academic_dataset_business.json"))
checkins <- stream_in(file("yelp_academic_dataset_checkin.json"))
reviews <- stream_in(file("yelp_academic_dataset_review.json"))
tips <- stream_in(file("yelp_academic_dataset_tip.json"))
users <- stream_in(file("yelp_academic_dataset_user.json"))

```

BUSINESS:
```{r}
str(bus)

compareNA <- function(v1,v2) {
    same <- (v1 == v2) | (is.na(v1) & is.na(v2))
    same[is.na(same)] <- FALSE
    return(same)
}

bus$attributes$`Wi-Fi` <- as.factor(bus$attributes$`Wi-Fi`)
levels(bus$attributes$`Wi-Fi`)
bus[is.na(bus$attributes$`Wi-Fi`),]$attributes$`Wi-Fi` <- 'myna'
nrow(bus[(bus$attributes$`Wi-Fi`=="paid"),])

```

Checkin:
```{r}
str(checkins)

```

Review:
```{r}
str(reviews)

```

Tip:
```{r}
str(tips)
```

User:
```{r}
users[is.na(users$fans),]$fans <- 0
users[is.na(users$compliments$funny),]$compliments$funny <- 0
str(users)

r1c1 <- nrow(users[(users$compliments$funny<=1) & (users$fans<=1),])
r1c2 <- nrow(users[(users$compliments$funny<=1) & (users$fans>1),])
r2c1 <- nrow(users[(users$compliments$funny>1) & (users$fans<=1),])
r2c2 <- nrow(users[(users$compliments$funny>1) & (users$fans>1),])


mdat <- matrix(c(r1c1,r1c2, r2c1,r2c2),nrow=2,ncol=2, byrow = TRUE, dimnames = list(c("funny<=1","funny>1"),c("fans<=1","fans>1")))
fisher.test(mdat)

```


